---
title: "Data Related Stuff"
author: "Dean Gladish"
date: "July 28, 2019"
output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


This R Markdown is just an inquiry into the statistics and facts surrounding data breaches in the United States.  Unlike the more traditional form of just summarizing the laws I wanted to create a document which would also give some helpful statistics which could be updated immediately.  

## Let's Begin


\ \ \ \ \ \ \ This shiny app is intended to do just that.  

```{r Load and wrangle data, message = FALSE, warning = FALSE, echo = FALSE}
library(readr)

statesData <- read_csv("statesSimplified.csv")


# Remove unneeded columns
statesData <- subset(statesData, select = c(1:13))

# Replace all NA values with the integer 0
statesData[is.na(statesData)] <- 0


library(ggplot2)




ggplot(data = statesData, mapping = aes(x = modifiedLawsin2018or2019, fill = modifiedLawsin2018or2019)) + 
  geom_bar() + 
  labs(title = "Proportion of States", x = "", y = "Number of States") + 
  theme(panel.background = element_blank()) + 
  geom_hline(yintercept = seq(0, 50, by = 10), col = "white", lwd = 1) + 
  theme(axis.text.y = element_blank(), axis.ticks = element_blank()) +
  geom_text(aes(label=..count..), stat="count", position = position_stack(), vjust = 1.5, color = "white") + 
  theme(legend.position = "none") + 
  scale_x_discrete(limit = c("FALSE", "TRUE"),
                     labels = c("Did not modify laws 2018-2019", "Modified laws 2018-2019"))
  
ggplot(statesData) + 
  geom_bar(mapping = aes(x = reorder(State, thresholdNotifyAG), y = thresholdNotifyAG), stat = "identity") + 
  xlab("State") + 
  theme(panel.background = element_blank()) + 
  theme(axis.ticks = element_blank()) + 
  labs(title = "States and Threshold", x = "To Notify the Attorney General") + 
  geom_hline(yintercept = seq(0, 1000, by = 250), colour = "gray", size = 1, linetype = 21) + 
  coord_flip()


```


```{r Shiny App for Data Breach Laws, echo = FALSE}
axis_vars_trueFalse <- c(
  "Did the State Modify its Law"
)
```












